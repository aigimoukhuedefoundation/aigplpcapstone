<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Capstone Project Quiz</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState } = React;

    // Lucide React Icons as Components
    const ChevronRight = () => (
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="m9 18 6-6-6-6"/>
      </svg>
    );

    const ChevronLeft = () => (
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="m15 18-6-6 6-6"/>
      </svg>
    );

    const Award = ({ size = 48 }) => (
      <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <circle cx="12" cy="8" r="6"/>
        <path d="M15.477 12.89 17 22l-5-3-5 3 1.523-9.11"/>
      </svg>
    );

    const User = ({ size = 16 }) => (
      <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/>
        <circle cx="12" cy="7" r="4"/>
      </svg>
    );

    const Briefcase = ({ size = 16 }) => (
      <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <rect width="20" height="14" x="2" y="7" rx="2" ry="2"/>
        <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/>
      </svg>
    );

    const Building2 = ({ size = 16 }) => (
      <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <rect width="16" height="20" x="4" y="2" rx="2" ry="2"/>
        <path d="M9 22v-4h6v4"/>
        <path d="M8 6h.01"/>
        <path d="M16 6h.01"/>
        <path d="M12 6h.01"/>
        <path d="M12 10h.01"/>
        <path d="M12 14h.01"/>
        <path d="M16 10h.01"/>
        <path d="M16 14h.01"/>
        <path d="M8 10h.01"/>
        <path d="M8 14h.01"/>
      </svg>
    );

    const CapstoneQuiz = () => {
      const [currentStep, setCurrentStep] = useState('intro');
      const [currentQuestion, setCurrentQuestion] = useState(0);
      const [userInfo, setUserInfo] = useState({ name: '', designation: '', organisation: '' });
      const [answers, setAnswers] = useState({});
      const [result, setResult] = useState(null);
      const [isSubmitting, setIsSubmitting] = useState(false);

      const questions = [
        {
          id: 1,
          text: "What motivates you most in your public service role?",
          options: [
            { label: "Streamlining processes and reducing inefficiencies", value: "A", categories: ["Digital Transformation"] },
            { label: "Empowering citizens through better access to services", value: "B", categories: ["Public Service Delivery Improvement"] },
            { label: "Influencing policy for long-term impact", value: "C", categories: ["Policy Reform"] },
            { label: "Promoting inclusion and equity", value: "D", categories: ["Gender & Social Inclusion"] }
          ]
        },
        {
          id: 2,
          text: "Which of these challenges do you feel most equipped to tackle?",
          options: [
            { label: "Poor data use in decision-making", value: "A", categories: ["Data & Evidence-Based Decision Making"] },
            { label: "Weak citizen trust in government", value: "B", categories: ["Citizen Engagement"] },
            { label: "Resistance to change within institutions", value: "C", categories: ["Organisational Culture & Change Management"] },
            { label: "Lack of climate-conscious policies", value: "D", categories: ["Climate Action & Sustainability"] }
          ]
        },
        {
          id: 3,
          text: "What kind of legacy do you want to leave?",
          options: [
            { label: "A modernised, tech-enabled ministry", value: "A", categories: ["Digital Transformation"] },
            { label: "A more responsive and accountable public service", value: "B", categories: ["Public Service Delivery Improvement"] },
            { label: "A policy that reshaped national priorities", value: "C", categories: ["Policy Reform"] },
            { label: "A more inclusive and sustainable future", value: "D", categories: ["Gender & Social Inclusion", "Climate Action & Sustainability"] }
          ]
        },
        {
          id: 4,
          text: "What kind of work energises you most?",
          options: [
            { label: "Designing systems and automating workflows", value: "A", categories: ["Digital Transformation"] },
            { label: "Solving service delivery bottlenecks", value: "B", categories: ["Public Service Delivery Improvement"] },
            { label: "Facilitating stakeholder consultations", value: "C", categories: ["Citizen Engagement"] },
            { label: "Conducting research and analysis", value: "D", categories: ["Data & Evidence-Based Decision Making"] }
          ]
        },
        {
          id: 5,
          text: "Which skill do you most identify with?",
          options: [
            { label: "Strategic thinking and policy analysis", value: "A", categories: ["Policy Reform"] },
            { label: "Data interpretation and reporting", value: "B", categories: ["Data & Evidence-Based Decision Making"] },
            { label: "Leading teams through change", value: "C", categories: ["Organisational Culture & Change Management"] },
            { label: "Advocating for vulnerable populations", value: "D", categories: ["Gender & Social Inclusion"] }
          ]
        },
        {
          id: 6,
          text: "What kind of impact do you want your capstone to have?",
          options: [
            { label: "Improve internal operations and efficiency", value: "A", categories: ["Digital Transformation"] },
            { label: "Enhance citizen experience with government services", value: "B", categories: ["Public Service Delivery Improvement"] },
            { label: "Influence national or sectoral policy", value: "C", categories: ["Policy Reform"] },
            { label: "Shift mindsets and behaviours in the public sector", value: "D", categories: ["Organisational Culture & Change Management"] }
          ]
        },
        {
          id: 7,
          text: "Which of these best describes your leadership style?",
          options: [
            { label: "Analytical and systems-oriented", value: "A", categories: ["Digital Transformation", "Data & Evidence-Based Decision Making"] },
            { label: "Empathetic and service-driven", value: "B", categories: ["Public Service Delivery Improvement", "Gender & Social Inclusion"] },
            { label: "Visionary and reform-minded", value: "C", categories: ["Policy Reform", "Climate Action & Sustainability"] },
            { label: "Collaborative and change-focused", value: "D", categories: ["Organisational Culture & Change Management", "Citizen Engagement"] }
          ]
        },
        {
          id: 8,
          text: "If you had to choose a project partner, who would it be?",
          options: [
            { label: "A data scientist or IT expert", value: "A", categories: ["Digital Transformation", "Data & Evidence-Based Decision Making"] },
            { label: "A frontline service provider", value: "B", categories: ["Public Service Delivery Improvement"] },
            { label: "A policy advisor or legislator", value: "C", categories: ["Policy Reform"] },
            { label: "A community organiser or activist", value: "D", categories: ["Citizen Engagement", "Gender & Social Inclusion"] }
          ]
        },
        {
          id: 9,
          text: "What challenge stalls your productivity and impacts you the most?",
          options: [
            { label: "Outdated systems and manual processes", value: "A", categories: ["Digital Transformation"] },
            { label: "Poor service coordination and delivery gaps", value: "B", categories: ["Public Service Delivery Improvement"] },
            { label: "Lack of clear policy direction or conflicting mandates", value: "C", categories: ["Policy Reform"] },
            { label: "Low staff morale and resistance to new ideas", value: "D", categories: ["Organisational Culture & Change Management"] }
          ]
        }
      ];

      const categoryDescriptions = {
        "Digital Transformation": {
          description: "You're a tech-forward innovator who sees the potential of technology to revolutionise public service!",
          projects: [
            "Automating Personnel Records",
            "E-Government Service Portal",
            "Digital Procurement System",
            "Mobile App for Public Service Requests"
          ]
        },
        "Public Service Delivery Improvement": {
          description: "You're passionate about making government work better for citizens through operational excellence!",
          projects: [
            "One-Stop Service Centres",
            "Reducing Service Bottlenecks",
            "Performance Dashboard",
            "Citizen Feedback Loop"
          ]
        },
        "Policy Reform": {
          description: "You're a strategic thinker who understands that great policies create lasting change!",
          projects: [
            "Policy Harmonisation",
            "Evidence-Based Policy Development",
            "Gender Mainstreaming Policy",
            "Climate Policy Integration"
          ]
        },
        "Citizen Engagement": {
          description: "You believe that government is strongest when citizens have a voice in decision-making!",
          projects: [
            "Participatory Budgeting Platform",
            "Community Dialogue Forums",
            "Digital Citizen Engagement Tool",
            "Public Awareness Campaign"
          ]
        },
        "Organisational Culture & Change Management": {
          description: "You're a change champion who knows that culture eats strategy for breakfast!",
          projects: [
            "Change Readiness Assessment",
            "Leadership Development Toolkit",
            "Employee Engagement Programme",
            "Innovation Lab"
          ]
        },
        "Data & Evidence-Based Decision Making": {
          description: "You're data-driven and believe that evidence should guide every decision!",
          projects: [
            "Data Analytics Unit",
            "Open Data Portal",
            "Performance Monitoring System",
            "Data Literacy Training"
          ]
        },
        "Climate Action & Sustainability": {
          description: "You're committed to building a sustainable future for the next generation!",
          projects: [
            "Green Procurement Policy",
            "Climate Risk Assessment Tool",
            "Renewable Energy Pilot",
            "Waste Management Initiative"
          ]
        },
        "Gender & Social Inclusion": {
          description: "You're an equity advocate who ensures no one is left behind!",
          projects: [
            "Gender Audit of Policies",
            "Inclusive Service Delivery Framework",
            "Women in Leadership Programme",
            "Disability Access Plan"
          ]
        }
      };

      const calculateResult = () => {
        const tallies = {};
        
        Object.values(answers).forEach(answer => {
          answer.categories.forEach(category => {
            tallies[category] = (tallies[category] || 0) + 1;
          });
        });

        const sortedCategories = Object.entries(tallies)
          .sort((a, b) => b[1] - a[1])
          .map(([category, count]) => ({ category, count }));

        return sortedCategories;
      };

      const handleUserInfoSubmit = () => {
        if (userInfo.name && userInfo.designation && userInfo.organisation) {
          setCurrentStep('quiz');
        }
      };

      const handleAnswerSelect = (option) => {
        setAnswers({
          ...answers,
          [currentQuestion]: {
            questionId: questions[currentQuestion].id,
            value: option.value,
            categories: option.categories
          }
        });
      };

      const handleNext = () => {
        if (currentQuestion < questions.length - 1) {
          setCurrentQuestion(currentQuestion + 1);
        } else {
          const results = calculateResult();
          setResult(results);
          submitToGoogleSheets(results);
          setCurrentStep('result');
        }
      };

      const handlePrevious = () => {
        if (currentQuestion > 0) {
          setCurrentQuestion(currentQuestion - 1);
        }
      };

      const submitToGoogleSheets = async (results) => {
        setIsSubmitting(true);
        
        // Replace this URL with your Google Apps Script Web App URL
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzRHDBlZXRR4fLRdJmfN47muLOCdVpx44Nr2Vu6S9lNF7wJxNR4GIIe3tU3sa6p74EE/exec';
        
        const data = {
          timestamp: new Date().toISOString(),
          name: userInfo.name,
          designation: userInfo.designation,
          organisation: userInfo.organisation,
          topCategory: results[0]?.category || '',
          topCategoryScore: results[0]?.count || 0,
          secondCategory: results[1]?.category || '',
          secondCategoryScore: results[1]?.count || 0,
          allAnswers: Object.values(answers).map(a => a.value).join(', ')
        };

        try {
          await fetch(GOOGLE_SCRIPT_URL, {
            method: 'POST',
            mode: 'no-cors',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify(data)
          });
        } catch (error) {
          console.error('Error submitting to Google Sheets:', error);
        } finally {
          setIsSubmitting(false);
        }
      };

      const progress = ((currentQuestion + 1) / questions.length) * 100;

      return (
        <div className="min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 p-4">
          <div className="max-w-3xl mx-auto">
            {/* Intro Screen */}
            {currentStep === 'intro' && (
              <div className="bg-white rounded-2xl shadow-xl p-8 mt-8">
                <div className="text-center mb-8">
                  <div className="inline-block p-4 rounded-full mb-4" style={{ backgroundColor: '#f94b01' }}>
                    <Award size={48} />
                  </div>
                  <h1 className="text-4xl font-bold mb-3" style={{ color: '#86271c' }}>
                    What Should Your Capstone Project Focus Be?
                  </h1>
                  <p className="text-xl text-gray-600">
                    Discover your ideal project direction in just 9 questions!
                  </p>
                </div>

                <div className="space-y-6">
                  <div>
                    <label className="flex items-center gap-2 text-sm font-medium mb-2" style={{ color: '#373737' }}>
                      <User size={16} />
                      Full Name
                    </label>
                    <input
                      type="text"
                      value={userInfo.name}
                      onChange={(e) => setUserInfo({ ...userInfo, name: e.target.value })}
                      className="w-full px-4 py-3 rounded-lg border-2 border-gray-200 focus:border-orange-500 focus:outline-none transition-colors"
                      placeholder="Enter your full name"
                    />
                  </div>

                  <div>
                    <label className="flex items-center gap-2 text-sm font-medium mb-2" style={{ color: '#373737' }}>
                      <Briefcase size={16} />
                      Designation
                    </label>
                    <input
                      type="text"
                      value={userInfo.designation}
                      onChange={(e) => setUserInfo({ ...userInfo, designation: e.target.value })}
                      className="w-full px-4 py-3 rounded-lg border-2 border-gray-200 focus:border-orange-500 focus:outline-none transition-colors"
                      placeholder="Enter your job title"
                    />
                  </div>

                  <div>
                    <label className="flex items-center gap-2 text-sm font-medium mb-2" style={{ color: '#373737' }}>
                      <Building2 size={16} />
                      Organisation
                    </label>
                    <input
                      type="text"
                      value={userInfo.organisation}
                      onChange={(e) => setUserInfo({ ...userInfo, organisation: e.target.value })}
                      className="w-full px-4 py-3 rounded-lg border-2 border-gray-200 focus:border-orange-500 focus:outline-none transition-colors"
                      placeholder="Enter your organisation"
                    />
                  </div>

                  <button
                    onClick={handleUserInfoSubmit}
                    disabled={!userInfo.name || !userInfo.designation || !userInfo.organisation}
                    className={`w-full py-4 px-6 rounded-lg text-white font-semibold text-lg flex items-center justify-center gap-2 transition-opacity ${
                      !userInfo.name || !userInfo.designation || !userInfo.organisation
                        ? 'opacity-50 cursor-not-allowed'
                        : 'hover:opacity-90'
                    }`}
                    style={{ backgroundColor: '#f94b01' }}
                  >
                    Start Quiz
                    <ChevronRight />
                  </button>
                </div>
              </div>
            )}

            {/* Quiz Screen */}
            {currentStep === 'quiz' && (
              <div className="bg-white rounded-2xl shadow-xl p-8 mt-8">
                {/* Progress Bar */}
                <div className="mb-8">
                  <div className="flex justify-between text-sm mb-2" style={{ color: '#373737' }}>
                    <span className="font-medium">Question {currentQuestion + 1} of {questions.length}</span>
                    <span className="font-medium">{Math.round(progress)}%</span>
                  </div>
                  <div className="w-full bg-gray-200 rounded-full h-3">
                    <div
                      className="h-3 rounded-full transition-all duration-300"
                      style={{ width: `${progress}%`, backgroundColor: '#f94b01' }}
                    />
                  </div>
                </div>

                {/* Question */}
                <div className="mb-8">
                  <h2 className="text-2xl font-bold mb-6" style={{ color: '#86271c' }}>
                    {questions[currentQuestion].text}
                  </h2>

                  <div className="space-y-3">
                    {questions[currentQuestion].options.map((option, idx) => (
                      <button
                        key={idx}
                        onClick={() => handleAnswerSelect(option)}
                        className={`w-full p-4 rounded-lg text-left transition-all border-2 ${
                          answers[currentQuestion]?.value === option.value
                            ? 'border-orange-500 bg-orange-50'
                            : 'border-gray-200 hover:border-gray-300 bg-white'
                        }`}
                      >
                        <div className="flex items-start gap-3">
                          <div
                            className={`flex-shrink-0 w-6 h-6 rounded-full border-2 flex items-center justify-center ${
                              answers[currentQuestion]?.value === option.value
                                ? 'border-orange-500 bg-orange-500'
                                : 'border-gray-300'
                            }`}
                          >
                            {answers[currentQuestion]?.value === option.value && (
                              <div className="w-3 h-3 bg-white rounded-full" />
                            )}
                          </div>
                          <span className="font-medium" style={{ color: '#373737' }}>
                            {option.label}
                          </span>
                        </div>
                      </button>
                    ))}
                  </div>
                </div>

                {/* Navigation */}
                <div className="flex gap-3">
                  {currentQuestion > 0 && (
                    <button
                      onClick={handlePrevious}
                      className="px-6 py-3 rounded-lg font-semibold flex items-center gap-2 border-2 transition-colors"
                      style={{ borderColor: '#373737', color: '#373737' }}
                    >
                      <ChevronLeft />
                      Previous
                    </button>
                  )}
                  <button
                    onClick={handleNext}
                    disabled={!answers[currentQuestion]}
                    className={`flex-1 py-3 px-6 rounded-lg text-white font-semibold flex items-center justify-center gap-2 transition-opacity ${
                      !answers[currentQuestion] ? 'opacity-50 cursor-not-allowed' : 'hover:opacity-90'
                    }`}
                    style={{ backgroundColor: '#f94b01' }}
                  >
                    {currentQuestion === questions.length - 1 ? 'See Results' : 'Next'}
                    <ChevronRight />
                  </button>
                </div>
              </div>
            )}

            {/* Results Screen */}
            {currentStep === 'result' && result && (
              <div className="bg-white rounded-2xl shadow-xl p-8 mt-8">
                <div className="text-center mb-8">
                  <div className="inline-block p-4 rounded-full mb-4" style={{ backgroundColor: '#f94b01' }}>
                    <Award size={48} />
                  </div>
                  <h1 className="text-3xl font-bold mb-2" style={{ color: '#86271c' }}>
                    Your Results Are In, {userInfo.name}!
                  </h1>
                  <h3 className="font-semibold mb-2" style={{ color: '#373737' }}>
                    Your suggested reform strength, based on your response is ðŸŽ‰
                  </p>
                </div>

                {/* Top Category */}
                <div className="mb-8 p-6 rounded-xl" style={{ backgroundColor: '#fff5f0' }}>
                  <div className="flex items-center justify-between mb-3">
                    <h2 className="text-2xl font-bold" style={{ color: '#86271c' }}>
                      {result[0].category}
                    </h2>
                    <span className="text-3xl font-bold" style={{ color: '#f94b01' }}>
                      {result[0].count}/{questions.length}
                    </span>
                  </div>
                  <p className="text-lg mb-4" style={{ color: '#373737' }}>
                    {categoryDescriptions[result[0].category].description}
                  </p>
                  
                  <h3 className="font-semibold mb-2" style={{ color: '#86271c' }}>
                    Recommended Project Ideas:
                  </h3>
                  <ul className="space-y-2">
                    {categoryDescriptions[result[0].category].projects.map((project, idx) => (
                      <li key={idx} className="flex items-start gap-2">
                        <span style={{ color: '#f94b01' }}>âœ“</span>
                        <span style={{ color: '#373737' }}>{project}</span>
                      </li>
                    ))}
                  </ul>
                </div>

                {/* Secondary Categories */}
                {result.length > 1 && result[1].count > 0 && (
                  <div className="mb-8">
                    <h3 className="font-semibold mb-3" style={{ color: '#86271c' }}>
                      You also show strength in:
                    </h3>
                    <div className="space-y-3">
                      {result.slice(1, 3).map((cat, idx) => (
                        <div key={idx} className="p-4 rounded-lg border-2 border-gray-200">
                          <div className="flex justify-between items-center">
                            <span className="font-medium" style={{ color: '#373737' }}>
                              {cat.category}
                            </span>
                            <span className="font-semibold" style={{ color: '#f94b01' }}>
                              {cat.count}/{questions.length}
                            </span>
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>
                )}

                {isSubmitting && (
                  <p className="text-center text-sm text-gray-500 mb-4">
                    Saving your results...
                  </p>
                )}

                <div className="text-center p-6 rounded-lg" style={{ backgroundColor: '#f5f5f5' }}>
                  <p className="font-semibold mb-2" style={{ color: '#373737' }}>
                    Ready to make an impact?
                  </p>
                  <p className="text-sm text-gray-600">
                    Use these insights to shape a capstone project that aligns with your strengths and passion!
                  </p>
                </div>
              </div>
            )}
          </div>
        </div>
      );
    };

    ReactDOM.render(<CapstoneQuiz />, document.getElementById('root'));
  </script>
</body>
</html>
